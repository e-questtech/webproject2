{% extends "base.html" %}
{% block title %} Student Registration
{% endblock %}
{% block head %}
{{ super() }}
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2>Register as a Prospective Student</h2>
    <form id="registrationForm">
        <div class="form-group">
            <label for="fullName">Full Name</label>
            <input type="text" class="form-control" id="fullName" name="fullName" placeholder="Enter Full Name" required>
        </div>

        <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" class="form-control" id="email" name="email" placeholder="Enter Email" required>
        </div>

        <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="text" class="form-control" id="phone" name="phone" placeholder="Enter Phone Number" required>
        </div>

        <div class="form-group">
            <label for="countryCode">Country Code</label>
            <select class="form-control" id="countryCode" name="countryCode" required>
                <option value="+234">+234 Nigeria</option>
                
            </select>
        </div>

        <div class="form-group">
            <label for="course">Preferred Course</label>
            <select class="form-control" id="course" name="course" required>
                {% for i in courses %}
                <option  name = "courses" value="{{ i['course_code'] }}" >{{ i['course_title'] }}</option>
            {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="state">State of Residence</label>
            <select class="form-control" id="state" name="state" required>
                <option value="Abia">Abia</option>
                <option value="Anambra">Anambra</option>
                <option value="Ebonyi">Ebonyi</option>
                <option value="Enugu">Enugu</option>
                <option value="Imo">Imo</option>
                <option value="Other">Other</option>
            </select>
        </div>

        <div class="form-group" id="otherStateField" style="display:none;">
            <label for="otherState">Enter State</label>
            <input type="text" class="form-control" id="otherState" name="otherState" placeholder="Enter State">
        </div>

        <button type="submit" class="btn btn-primary">Register</button>
    </form>

    <div id="statusMessage" class="mt-3" style="display:none;">
        <p class="alert alert-success">Submitted successfully!</p>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    // Show or hide the 'Other State' field based on the selected state
    $('#state').on('change', function() {
        if ($(this).val() === 'Other') {
            $('#otherStateField').show();
        } else {
            $('#otherStateField').hide();
        }
    });

    // Handle form submission with AJAX to prevent reloading
    $('#registrationForm').on('submit', function(event) {
        event.preventDefault();  // Prevent page reload
        var formData = $(this).serialize();  // Get form data

        $.ajax({
            type: 'POST',
            url: '/register_student',  // Replace with your Flask route
            data: formData,
            success: function(response) {
                $('#statusMessage').show();  // Show success message
                setTimeout(function() {
                    $('#statusMessage').hide();  // Hide after 3 seconds
                }, 3000);
                $('#registrationForm')[0].reset();  // Clear the form
            }
        });
    });
</script>
{% endblock %}
